<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WillOfCode AI - Your Intelligent Coding Assistant</title>
    <meta name="description" content="AI-powered coding assistant for code generation, debugging, and explanations">
    <link rel="stylesheet" href="styles.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
</head>

<body>
    <div class="app-container">
        <!-- Animated Background -->
        <div class="bg-grid"></div>
        <div class="glow glow-1"></div>
        <div class="glow glow-2"></div>
        <div class="glow glow-3"></div>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>Chat History</h2>
                <button class="sidebar-close" id="sidebarClose" aria-label="Close sidebar">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="sidebar-content">
                <button class="new-chat-btn" id="newChatBtn">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    New Chat
                </button>
                <div class="chat-history" id="chatHistory">
                    <!-- Chat history items will be added dynamically -->
                </div>
            </div>
        </aside>

        <!-- Main Container -->
        <div class="container">
            <!-- Header -->
            <header class="header">
                <div class="header-left">
                    <button class="menu-btn" id="menuBtn" aria-label="Open menu">
                        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="3" y1="12" x2="21" y2="12"></line>
                            <line x1="3" y1="6" x2="21" y2="6"></line>
                            <line x1="3" y1="18" x2="21" y2="18"></line>
                        </svg>
                    </button>
                    <div class="brand">
                        <div class="brand-icon">
                            <div class="icon-pulse"></div>
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="brand-logo">
                                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"
                                    stroke="url(#brandGradDark)" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="logo-path" />
                                <defs>
                                    <linearGradient id="brandGradDark" x1="2" y1="2" x2="22" y2="22">
                                        <stop stop-color="#00ff88" />
                                        <stop offset="1" stop-color="#00d4ff" />
                                    </linearGradient>
                                    <linearGradient id="brandGradLight" x1="2" y1="2" x2="22" y2="22">
                                        <stop stop-color="#dc2626" />
                                        <stop offset="1" stop-color="#ef4444" />
                                    </linearGradient>
                                </defs>
                            </svg>
                        </div>
                        <div class="brand-info">
                            <span class="brand-name">WillOfCode</span>
                            <span class="brand-tag">AI-Powered</span>
                        </div>
                    </div>
                </div>
                <div class="header-right">
                    <div class="status">
                        <span class="status-dot"></span>
                        <span class="status-text">Online</span>
                    </div>
                    <button class="theme-toggle" id="themeToggle" aria-label="Toggle theme">
                        <svg class="sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="5"></circle>
                            <line x1="12" y1="1" x2="12" y2="3"></line>
                            <line x1="12" y1="21" x2="12" y2="23"></line>
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                            <line x1="1" y1="12" x2="3" y2="12"></line>
                            <line x1="21" y1="12" x2="23" y2="12"></line>
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                        </svg>
                        <svg class="moon-icon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                        </svg>
                    </button>
                    <button class="header-btn" id="fileBrowserBtn" title="Browse Files">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z" />
                        </svg>
                    </button>
                    <button class="clear-chat-btn" id="clearChatBtn" title="Clear chat">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="3 6 5 6 21 6"></polyline>
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                            </path>
                        </svg>
                    </button>
                    <button class="header-btn" id="toggleEditorBtn" title="Toggle Editor Panel">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                            <line x1="12" y1="3" x2="12" y2="21" />
                        </svg>
                    </button>
                </div>
            </header>

            <!-- Main Content Area with Split Panels -->
            <div class="main-content" id="mainContent">
                <!-- Chat Wrapper (contains chat + input in column) -->
                <div class="chat-wrapper">
                    <!-- Chat Area -->
                    <main class="chat" id="chat">
                        <!-- Welcome -->
                        <div class="welcome" id="welcome">
                            <div class="welcome-orb">
                                <div class="orb-ring"></div>
                                <div class="orb-ring"></div>
                                <div class="orb-ring"></div>
                                <div class="orb-core"></div>
                            </div>
                            <h1 class="welcome-title">Hello, I'm <span class="gradient-text">WillOfCode</span></h1>
                            <p class="welcome-desc">Your AI coding assistant. I can generate, debug, review, refactor,
                                test, document, and optimize your code.</p>

                            <div class="capabilities">
                                <div class="cap-item" onclick="useSuggestion('Create a REST API with Express.js')">
                                    <div class="cap-icon">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <polyline points="16 18 22 12 16 6" />
                                            <polyline points="8 6 2 12 8 18" />
                                        </svg>
                                    </div>
                                    <div class="cap-text">
                                        <span class="cap-title">Generate</span>
                                        <span class="cap-desc">Create new code</span>
                                    </div>
                                </div>
                                <div class="cap-item" onclick="useSuggestion('Debug: function returns undefined')">
                                    <div class="cap-icon">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <circle cx="12" cy="12" r="10" />
                                            <line x1="12" y1="8" x2="12" y2="12" />
                                            <line x1="12" y1="16" x2="12.01" y2="16" />
                                        </svg>
                                    </div>
                                    <div class="cap-text">
                                        <span class="cap-title">Debug</span>
                                        <span class="cap-desc">Find & fix bugs</span>
                                    </div>
                                </div>
                                <div class="cap-item" onclick="useSuggestion('Explain async/await in JavaScript')">
                                    <div class="cap-icon">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" />
                                            <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />
                                        </svg>
                                    </div>
                                    <div class="cap-text">
                                        <span class="cap-title">Explain</span>
                                        <span class="cap-desc">Learn concepts</span>
                                    </div>
                                </div>
                                <div class="cap-item" onclick="useSuggestion('Review this code for best practices')">
                                    <div class="cap-icon">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                            <path d="M9 15l2 2 4-4" />
                                        </svg>
                                    </div>
                                    <div class="cap-text">
                                        <span class="cap-title">Review</span>
                                        <span class="cap-desc">Code quality check</span>
                                    </div>
                                </div>
                                <div class="cap-item"
                                    onclick="useSuggestion('Refactor this code for better structure')">
                                    <div class="cap-icon">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <path
                                                d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" />
                                        </svg>
                                    </div>
                                    <div class="cap-text">
                                        <span class="cap-title">Refactor</span>
                                        <span class="cap-desc">Improve structure</span>
                                    </div>
                                </div>
                                <div class="cap-item" onclick="useSuggestion('Generate unit tests for this code')">
                                    <div class="cap-icon">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <path
                                                d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z" />
                                        </svg>
                                    </div>
                                    <div class="cap-text">
                                        <span class="cap-title">Test</span>
                                        <span class="cap-desc">Generate tests</span>
                                    </div>
                                </div>
                                <div class="cap-item" onclick="useSuggestion('Add documentation to this code')">
                                    <div class="cap-icon">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                            <line x1="16" y1="13" x2="8" y2="13" />
                                            <line x1="16" y1="17" x2="8" y2="17" />
                                            <line x1="10" y1="9" x2="8" y2="9" />
                                        </svg>
                                    </div>
                                    <div class="cap-text">
                                        <span class="cap-title">Document</span>
                                        <span class="cap-desc">Add docstrings</span>
                                    </div>
                                </div>
                                <div class="cap-item" onclick="useSuggestion('Optimize this code for performance')">
                                    <div class="cap-icon">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2">
                                            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                                        </svg>
                                    </div>
                                    <div class="cap-text">
                                        <span class="cap-title">Optimize</span>
                                        <span class="cap-desc">Boost performance</span>
                                    </div>
                                </div>
                            </div>

                            <div class="quick-actions">
                                <span class="quick-label">Try:</span>
                                <div class="quick-chips">
                                    <button class="chip"
                                        onclick="useSuggestion('Create a sorting algorithm')">Generate</button>
                                    <button class="chip" onclick="useSuggestion('Review this code')">Review</button>
                                    <button class="chip"
                                        onclick="useSuggestion('Refactor for clean code')">Refactor</button>
                                    <button class="chip" onclick="useSuggestion('Generate unit tests')">Test</button>
                                </div>
                            </div>
                        </div>

                        <!-- Messages Container -->
                        <div class="messages" id="messages"></div>
                    </main>

                    <!-- Input -->
                    <footer class="input-section">
                        <form id="chatForm" class="input-form">
                            <div class="input-box">
                                <div class="input-glow"></div>
                                <button type="button" class="attach-btn" id="attachBtn" title="MCP Tools">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                        stroke-width="2">
                                        <path
                                            d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z" />
                                    </svg>
                                </button>
                                <!-- MCP Tools Dropdown -->
                                <div class="mcp-dropdown" id="mcpDropdown">
                                    <div class="mcp-dropdown-header">MCP Tools</div>
                                    <div class="mcp-dropdown-list" id="mcpToolsList">
                                        Loading...
                                    </div>
                                </div>
                                <textarea id="userInput" placeholder="Ask me anything about code..."
                                    rows="1"></textarea>
                                <div class="input-actions">
                                    <span class="char-count" id="charCount">0</span>
                                    <button type="submit" id="sendBtn" class="send-btn">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
                                            stroke="currentColor" stroke-width="2.5">
                                            <line x1="22" y1="2" x2="11" y2="13" />
                                            <polygon points="22 2 15 22 11 13 2 9 22 2" />
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </form>
                        <div class="input-footer">
                            <p>WillOfCode may produce inaccurate results. Verify important code.</p>
                            <div class="keyboard-hints">
                                <span><kbd>Enter</kbd> to send</span>
                                <span><kbd>Shift + Enter</kbd> for new line</span>
                            </div>
                        </div>
                    </footer>
                </div><!-- end chat-wrapper -->

                <!-- Code Editor Panel -->
                <aside class="editor-panel" id="editorPanel">
                    <div class="editor-header">
                        <div class="editor-title">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                                <polyline points="14 2 14 8 20 8" />
                            </svg>
                            <span id="editorFileName">No file open</span>
                        </div>
                        <div class="editor-actions">
                            <!-- Disconnect from Chat Button -->
                            <button class="editor-btn" id="disconnectEditorBtn"
                                title="Disconnect from chat (stop auto-sync)">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                                    <polyline points="15 3 21 3 21 9" />
                                    <line x1="10" y1="14" x2="21" y2="3" />
                                </svg>
                            </button>
                            <!-- Clear Editor Button -->
                            <button class="editor-btn" id="clearEditorBtn" title="Clear editor content">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <polyline points="3 6 5 6 21 6"></polyline>
                                    <path
                                        d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                                    </path>
                                </svg>
                            </button>
                            <button class="editor-btn" id="editorBrowseBtn" title="Browse files">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path
                                        d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z" />
                                </svg>
                            </button>
                            <div class="change-buttons hidden" id="changeButtons">
                                <button class="change-btn accept" id="acceptChangeBtn"
                                    title="Accept changes">&#10003;</button>
                                <button class="change-btn reject" id="rejectChangeBtn"
                                    title="Reject changes">&#10005;</button>
                            </div>
                            <button class="editor-btn save" id="editorSaveBtn" title="Save file" disabled>
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" />
                                    <polyline points="17 21 17 13 7 13 7 21" />
                                    <polyline points="7 3 7 8 15 8" />
                                </svg>
                                Save
                            </button>
                            <!-- Close Editor Button -->
                            <button class="editor-btn close" id="closeEditorBtn" title="Close editor panel">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                    stroke-width="2">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="editor-path">
                        <input type="text" id="editorPath" placeholder="Enter file path or use browser..." readonly>
                    </div>
                    <div class="editor-content">
                        <div class="line-numbers" id="lineNumbers"></div>
                        <textarea id="codeEditor" placeholder="Open a file to start editing..."
                            spellcheck="false"></textarea>
                    </div>
                    <div class="editor-footer">
                        <span class="editor-status" id="editorStatus">Ready</span>
                        <span class="editor-info" id="editorInfo">Lines: 0 | Chars: 0</span>
                    </div>
                </aside>
            </div>
        </div>

        <!-- File Browser Modal -->
        <div class="modal" id="fileBrowserModal">
            <div class="modal-backdrop" id="modalBackdrop"></div>
            <div class="modal-content file-browser">
                <div class="modal-header">
                    <h2>File Browser</h2>
                    <button class="modal-close" id="modalClose">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18"></line>
                            <line x1="6" y1="6" x2="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
                <div class="file-browser-toolbar">
                    <div class="drive-selector">
                        <select id="driveSelect">
                            <option value="">Select Drive</option>
                        </select>
                    </div>
                    <div class="path-bar">
                        <button class="path-btn" id="goUpBtn" title="Go up">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path d="M15 18l-6-6 6-6" />
                            </svg>
                        </button>
                        <input type="text" id="pathInput" class="path-input" placeholder="Enter path...">
                        <button class="path-btn" id="goPathBtn" title="Go to path">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <polyline points="9 18 15 12 9 6" />
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="file-browser-body">
                    <div class="file-list-container">
                        <div class="file-list" id="fileList">
                            <!-- Files will be loaded here -->
                        </div>
                    </div>
                    <div class="file-preview-container" id="filePreviewContainer">
                        <div class="file-preview-header">
                            <span id="previewFileName">No file selected</span>
                            <div class="preview-actions">
                                <button class="preview-btn" id="useFileBtn" title="Use in chat">Use in Chat</button>
                                <button class="preview-btn" id="copyPathBtn" title="Copy path">Copy Path</button>
                            </div>
                        </div>
                        <div class="file-preview-content" id="filePreviewContent">
                            <p class="preview-placeholder">Select a file to preview its contents</p>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <span class="selected-path" id="selectedPath">No file selected</span>
                    <button class="modal-btn primary" id="selectFileBtn">Select File</button>
                </div>
            </div>
        </div>

        <!-- Diff Preview Modal -->
        <div class="diff-modal" id="diffModal">
            <div class="diff-modal-backdrop" id="diffModalBackdrop"></div>
            <div class="diff-modal-content">
                <div class="diff-modal-header">
                    <h3>Proposed Changes</h3>
                    <span class="diff-file-name" id="diffFileName"></span>
                </div>
                <div class="diff-modal-body">
                    <div class="diff-summary" id="diffSummary"></div>
                    <div class="diff-view" id="diffView"></div>
                </div>
                <div class="diff-modal-footer">
                    <button class="action-btn reject" id="diffRejectBtn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="18" y1="6" x2="6" y2="18" />
                            <line x1="6" y1="6" x2="18" y2="18" />
                        </svg>
                        Reject
                    </button>
                    <button class="action-btn accept" id="diffAcceptBtn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="20 6 9 17 4 12" />
                        </svg>
                        Accept
                    </button>
                </div>
            </div>
        </div>

        <!-- Toast notification container -->
        <div class="toast-container" id="toastContainer"></div>

        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-python.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-javascript.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-typescript.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-jsx.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-css.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-sql.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-bash.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-json.min.js"></script>
        <script src="script.js"></script>
</body>

</html>